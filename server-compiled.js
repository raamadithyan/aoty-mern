(()=>{var t={860:t=>{"use strict";t.exports=require("express")},13:t=>{"use strict";t.exports=require("mongodb")},109:t=>{"use strict";t.exports=require("sanitize-html")},37:t=>{"use strict";t.exports=require("os")}},e={};function a(o){var s=e[o];if(void 0!==s)return s.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,a),r.exports}(()=>{const t=a(860),{MongoClient:e,ObjectId:o}=(a(37),a(13)),s=a(109),r=t();let i;r.set("view engine","ejs"),r.set("views","./view"),r.use(t.static("public")),r.use(t.json()),r.use(t.urlencoded({extended:"false"})),r.get("/",(async(t,e)=>{const a=await i.collection("animals").find().toArray();e.render("home",{query:a})})),r.use((function(t,e,a){e.set("WWW-Authenticate","Basic realm='AOTY'"),"Basic YWRtaW46YWRtaW4="===t.headers.authorization?a():(console.log(t.headers.authorization),e.status(401).send("Try Again"))})),r.get("/admin",((t,e)=>{e.render("admin")})),r.get("/api/topalbums",(async(t,e)=>{const a=await i.collection("topalbums").find().toArray();e.json(a)})),r.post("/addalbum",(function(t,e,a){"string"!=typeof t.body.album&&(t.body.album=""),"string"!=typeof t.body.artist&&(t.body.artist=""),"string"!=typeof t.body.year&&(t.body.year=""),"string"!=typeof t.body.imageurl&&(t.body.imageurl=""),"string"!=typeof t.body._id&&(t.body._id=""),t.cleanData={album:s(t.body.album.trim(),{allowedTags:[],allowedAttributes:{}}),artist:s(t.body.artist.trim(),{allowedTags:[],allowedAttributes:{}}),year:s(t.body.year.trim(),{allowedTags:[],allowedAttributes:{}}),imageurl:s(t.body.imageurl.trim(),{allowedTags:[],allowedAttributes:{}})},a()}),(async(t,e)=>{console.log(t.body);const a=await i.collection("topalbums").insertOne(t.cleanData),s=await i.collection("topalbums").findOne({_id:new o(a.insertedId)});e.send(s)})),async function(){const t=new e("mongodb+srv://raamadithyan:raamadithyan@cluster0.r8sszts.mongodb.net/AmazingMernApp?retryWrites=true&w=majority");await t.connect(),i=t.db(),r.listen(3e3)}()})()})();